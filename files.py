import os
import fnmatch

class Files:
    def __init__(self):
        self.vulnerabilitiy_register = ""
        self.vulnerabilities_found = ""



    def find_files(self,directory, pattern):
        matches = []
        for root, dirs, files in os.walk(directory):
            for filename in fnmatch.filter(files, pattern):
                matches.append(os.path.join(root, filename))
        return matches


    def files(self):
        current_directory = os.getcwd()
        document_extensions = ['*.csv', '*.txt']  # Add other document extensions as needed

        found_files = []
        for extension in document_extensions:
            found_files.extend(self.find_files(current_directory, extension))

        if found_files:
            print("Found documents:")
            for file in found_files:
                print(file)
        else:
            print("No documents found.")


    def upload_vulnerability_register(self):
        file_name = input("Enter the name of the vulnerability register CSV file to upload: ")
        if os.path.isfile(file_name):
            print(f"{file_name} uploaded successfully.")
            self.vulnerabilitiy_register = file_name
        else:
            print(f"\nFile {file_name} not found.")


    def upload_vulnerabilities_found(self):
        file_name = input("Enter the name of the vulnerabilities found file to upload: ")
        if os.path.isfile(file_name):
            print(f"{file_name} uploaded successfully.")
            self.vulnerabilities_found = file_name
        else:
            print(f"\nFile {file_name} not found.")